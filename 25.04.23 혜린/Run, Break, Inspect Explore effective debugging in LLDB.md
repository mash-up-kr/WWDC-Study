# Run, Break, Inspect: Explore effective debugging in LLDB

URL: https://developer.apple.com/videos/play/wwdc2024/10198/
status: 시작 전
when: WWDC 2024

- LLDB: Xcode와 함께 제공되는 디버깅 툴

# 디버깅 모델

![스크린샷 2025-04-23 오후 2.04.25.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.04.25.png)

프로그램 시작하고 나서 문제가 발생하는 사이에 잘못된 코드가 심어져있을텐데
우리의 목표는 그 코드를 찾아내는 것!
그리고 우리는 **프로그램 상태**를 체크해서 그 코드를 찾아내게 됨.

그럼 프로그램 상태는 어떻게 체크함?
여러가지 방법이 있는데

첫번째는 로그.

![스크린샷 2025-04-23 오후 2.06.01.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.06.01.png)

앱 상태를 개발자 ↔ 사용자 간에 전송이 가능하다는 것이 강점!

두번째 방법은 print debugging

![스크린샷 2025-04-23 오후 2.08.36.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.08.36.png)

우리가 맨날 하는거,,, 프린트문 넣고 다시 컴파일해서 찍히는 프린트문을 통해 상태를 확인할 수 있찌

## ➡️ 하지만 얘네는 늘 시간이 너무 많이 걸림
그럼 어떻게 해 ???

![스크린샷 2025-04-23 오후 2.09.48.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.09.48.png)

**디버거**를 사용해서 검색 공간을 빠르게 탐색해보자!!

LLDB를 쓸때는 응용 프로그램을 시작하지 않아도 됨!
그리고 늘 버그를 재현하는게 어려운데 그 부분에서도 도와줄 수 있다~.~ 어떻게~~~

# 충돌 로그 사용하기

![스크린샷 2025-04-23 오후 2.16.07.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.16.07.png)

애플 플랫폼에서 충돌날 때 마다 생성되는 충돌 로그. 여기에는 충돌 시점 당시 프로그램 상태에 대한 정보가 수집됨

충돌로그 우클 → Xcode로 오픈하면

![스크린샷 2025-04-23 오후 2.29.29.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.29.29.png)

이런 창이 뜹니다. 여기서 앱을 선택해주면 Xcode가 이 파일을 사용해서 프로젝트 맥락에서 어디서 오류가 발생했는지 알려줌

![스크린샷 2025-04-23 오후 2.30.21.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.30.21.png)

앱이 죽기 직전에 열려고 했던 파일 이름을 로깅해놨으니까 동료한테 로그 파일을 요청하면 됨

이 과정이 어떻게 가능하지?

## ➡️ 백트레이스

> 프로그램의 제어 흐름을 이해하기에 아주 유용한 도구
> 

이 상태를 유발한 함수 호출 또는 스택 프레임의 시퀀스를 설명함
각 함수가 어떤 작업을 하고 있었는지, 어디로 반환될지, 어디서 호출됐는지 등등

![스크린샷 2025-04-23 오후 2.32.43.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.32.43.png)

## Crashlog를 제대로 활용하기 위한 조건

- crashlog를 생성한 앱이 있는 커밋과 동일한 곳에 위치해야하며
- 해당 빌드에 대한 dSYM번들을 사용할 수 있어야함

# Breaking

![스크린샷 2025-04-23 오후 2.46.53.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.46.53.png)

이런 루프를 돌 예정

![스크린샷 2025-04-23 오후 2.36.41.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.36.41.png)

여기보면 브레이크 포인트를 하나 걸고 빌드했는데 LLDB가 갑자기 브레이크 포인트를 세 개의 포지션으로 바꿈
이것은 이렇게 서로 다른 코드 경로를 통해서 코드가 멈출 수 있다는 뜻임

![스크린샷 2025-04-23 오후 2.43.18.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.43.18.png)

한 곳에 브레이크 포인트를 걸었음. 얘가 호출될 수 있는 경우

1. 생성자
2. 후행클로저 실행
3. 버튼이 클릭될 때 호출되는 액션 클로저

![스크린샷 2025-04-23 오후 2.45.05.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.45.05.png)

이렇게 원하는 곳의 브레이크포인트만 활성화시키는 것도 가능함 ㄷㄷㄷ 오ㅜ왕

## CommandLine 사용하는 것도 가능

- 일단 멈춰!
    
    ![스크린샷 2025-04-23 오후 2.48.58.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.48.58.png)
    
    요고 눌러서,,
    
- ‘b’ 명령어로 중단점을 설정할 수 있음 (breakpoint set과 동일)
    
    ![스크린샷 2025-04-23 오후 2.49.38.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.49.38.png)
    
- 이렇게 브레이크 걸렸을 때 행동을 설정해줄 수 있음
    
    ![스크린샷 2025-04-23 오후 2.50.11.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.50.11.png)
    
    - 요런 명령어는 가장 최근의 중단점에 영향을 미치지만
    - 다른 브레이크 포인트의 id를 알고 있으면 걔한테도 설정을 해줄 수 있음
- help <command>를 통해 명령어에 대한 안내를 볼 수 있음
    
    ![스크린샷 2025-04-23 오후 2.52.18.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.52.18.png)
    
    - 첫번째는 모든 명령어에 대한 안내
    - 특정 명령의 옵션에 대해
    - 더 많은 LLDB기능을 알고 싶으면 apropros (검색 용인듯?)
        - ex. apropos backtrace

## High-firing breakpoints

특정 조건에서만 브레이크 포인트를 활성화시키기

```jsx
break modify <breakpoint ID> --condition "video.length > 60"
```

GUI에서도 condition을 작성해주면 됨

- breakpoint의 액션은 새로운 breakpoint를 만드는데도 사용될 수 있음
    - tbreak Importer.swift:67
        - 일케 써주면 딱 한 번만 거기서 프로그램이 멈출 수 있게 해줌

```jsx
break modify <breakpoint ID> --ignore-count 10
```

이렇게 하면 처음 10개의 브레이크 포인트를 무시하게함

# 프로그램 상태 알아보기(’p’)

지금까지는 start a program, breaking a program에 초점이 맞춰져있었음
그래서 이번에는 프로그램 상태를 알아볼 수 있는 ‘p’ 명령어에 대해 알아보겠음!

> dwim-print(do what I mean)
> 

![스크린샷 2025-04-23 오후 3.14.58.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.14.58.png)

로그에 대고 우클해서 해당 소스 코드위치로 점프 가능

### Swift Error breakpoint

LLDB에 swift error가 표시되는 즉시 응용 프로그램을 멈추라고 지시할 수 있음

![스크린샷 2025-04-23 오후 3.17.58.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.17.58.png)

### Swift6에서 차이점

p 명령어의 결과물을 커스텀할 수 있음
@DebugDescription 매크로 사용하면 됨(CustomDebugStringConvertible 대체)

![스크린샷 2025-04-23 오후 3.22.04.png](Run,%20Break,%20Inspect%20Explore%20effective%20debugging%20in%2008da7c89c6df482389df00176fd2a735/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-04-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.22.04.png)